# 3.1 - Hash Functions

A hash function `h()` is a keyless algorithm that takes a variable length input `x` and returns an output `y` of fixed length `n (message digest length)`.

## Cryptographic Hash Functions

We expect cryptographic hash functions to satisfy the following properties

### 1. Preimage Resistance

- Given an output `y` it should be hard to find any input `x` such that `h(x) = y`.
- A generic attach would require around `2^n` operations
- Example:
  - In a password file one does not store (`username, password`) but store (`username, hash(password`)
  - This is sufficient to verify a password
  - An attacker that captures the password file has to find a preimage

### 2. Second Preimage Resistance

- Given an out `y` and input `x1` such that `h(x1) = y`, it should be hard to find any other input `x2` such that `h(x2) = y`
- A generic attack would require around 2^n operations
- Example:
  - Store the hashes of your files on your computer or write them down on paper
  - If the attacker modifies the files (ex: put a malicious code inside them) and can still obtain the same hash value, then the attacker can fool you.

### 3. Collision Resistance

- It should be hard to find two inputs `x1` and `x2` such that `h(x1) = h(x2)`
- A generic attack would require around 2^(n/2) operations due to birthday paradox
- Example:
  - Hacker prepares two versions of a software driver for an OS where `x` is correct and `x'` contains a backdoor that allows access to the machine
  - Hacker sends `x` to the OS company for inspection
  - OS company signs the `h(x)` with their private key
  - Havcker distributes `x'` to the users who verify the signature on `x` with OS companies public key
  - Since `h(x) == h(x')`, the signature works

## Birthday Paradox

- How many people need to be in a room before it is more likely than not at least two people share a birthday? (Probability > 0.5)
- Solution:
  - Consider the probability that nobody shares a birthday. The first person in the group has a birthday  on a given day. To avoid a match, the second person is left with 364 potions, the third has only 363 and so on. The probability that we dont have any matches among a group of `t` people is:

![alt text](../imgs/3/birthdayparadox.png)
